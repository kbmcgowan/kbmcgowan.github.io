<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Kevin B. McGowan: segmenting EVA2 airflow with HTK</title>
    <link href="../../css/simple.css" rel="stylesheet" type="text/css" />

    <meta name="keywords" content="graduate student, phonetician, linguist, phonologist, computational linguistics, speech synthesis, coarticulation" />
    <meta name="description" content="Linguistics Graduate Student, husband, father, and geek." />
    <meta name="google-site-verification" content="GrZZuW6K4i14QCXoRaDHkiLayrY0EGXeteNT3pVraNs" />
    <link href='http://fonts.googleapis.com/css?family=Quicksand' rel='stylesheet' type='text/css' />
	<link href='http://fonts.googleapis.com/css?family=Voces' rel='stylesheet' type='text/css' />
    <script type="text/javascript" src="http://www-personal.umich.edu/~clunis/clunis.js" > </script>
    <!-- jQuery library - I get it from Google API's --> 
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script> 
    <!-- jQuery UI widget factory --> 
    <script src="../js/jquery.ui.widget.js" type="text/javascript"></script> 
    
    <!-- Smooth Div Scroll 1.0 - minified for faster loading--> 
    <script src="../js/jquery.smoothDivScroll-1.0-min.js" type="text/javascript"></script> 

    <script type="text/javascript"> 
	    $(function() {
		    $("div#makeMeScrollable").smoothDivScroll({ autoScroll: "onstart", 
			autoScrollDirection: "backandforth",
			autoScrollStep: 1,
			autoScrollInterval: 1000,
			hotSpotsVisibleTime: 5,
			startAtElementId: "first",
			visibleHotSpots: "always" });
	    });
    </script> 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-4867161-4']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body>


<div id="header">
	<div id="logo">
		<h1><a href="../">Kevin&nbsp;B.&nbsp;McGowan</a></h1>
		<h2><span id="addr"> i do not enjoy spam </span></h2>
	</div>
	<!-- end div#logo -->
	<div id="menu">
		<ul>
			<li><a href="../../">home</a></li>
			<li><a href="../../research/">research</a></li>
			<li><a href="../../teaching/">teaching</a></li>
			<li class="active"><a href="../../stuff/">stuff</a></li>
			<li><a href="../../cv/">cv</a></li>
		</ul>
	</div>
	<!-- end div#menu -->
</div>


<div class="columns">

<div class="singlecolumn">
<div class="box">
    <div class="onecolumn">

	<h2>Segmenting airflow with HTK &amp; Praat</h2>
	<p class="byline"><small>Last updated: March 23, 2009</small></p>

	<p>An airflow system like <a href="http://www.sqlab.fr/evaRootUK.htm">the SQLab EVA2</a> used in our lab creates separate wav-like files for audio, oral airflow, and nasal airflow.  Usually we use a program like <a href="http://www.speech.kth.se/wavesurfer/">wavesurfer</a> or <a href="http://www.fon.hum.uva.nl/praat/">Praat</a> to view these files and extract our measurements.

						</p>
						<p> But what if you want to extract measurements for all of the segments in a reasonably-sized corpus of continuous speech?  This can, of course, be done by hand but the process is tedious, labor-intensive, and inescapably subjective.</p>
						<p> This tutorial explains how to use Praat and HTK to segment audio recordings and use that segmentation to extract phone-level airflow data for an entire corpus.  The segmentation is unlikely to be as good as a trained linguist might achieve, but it's definitely faster and a very good starting point.  The corpus I'm working with is a set of recordings of the <a href="http://www.ldc.upenn.edu/Catalog/CatalogEntry.jsp?catalogId=LDC93S1">TIMIT</a> prompts I made for my doctoral candidacy qualifying project:  Modeling Airflow for Concatenative Speech Synthesis.

						<h2 class="title">Solution</h2>

						    <ol>
							<li>Convert the EVA2 files to WAV format.</li>
							    <p>
								SQLab distribute a piece of Windows-only, closed-source software called <a href="http://www.lpl.univ-aix.fr/~lpldev/lpltools/">RIFF Edit</a> for converting from their proprietary format to WAV format.  Works great on my Mac using <a href="http://www.codeweavers.com/products/">CrossOver</a> which, I believe, is just a very nice version of <a href="http://www.winehq.org/">wine</a>.
							    </p>

							<li>Break the audio recordings up into separate files (one prompt/sentence per file)</li>
							    <p>Of course there are many ways to do this.  Usually one would record each prompt separately so that the audio files are naturally in separate files.  The clumsy EVA2 system makes this arrangement difficult, though, so I used a TextGrid to mark each prompt on an interval tier.  This can be done automatically using Praat's "Annotate --> To TextGrid (Silences)" command (some clean-up is usually necessary, but it saves a lot of work).  Once the prompts are marked in the TextGrid I <a href="scripts/extract.praat">run this Praat script that I did not write</a>.
							    </p>
							    <p> ( As a quick aside, <a href="http://www.ling.upenn.edu/~kgorman/">Kyle Gorman</a> has written a terrific little Python class for manipulating TextGrids --does exactly what you'd want in just exactly the way you'd probably expect. )</a>
							    </p>

							<li>Now use the same TextGrid and script to extract prompts from the OAF (oral airflow) and NAF (nasal airflow) files.</li>
							<p>
							    This is the great strength of using something like Praat in the first place.  Be sure to check a random sample of your alignments to make sure everything worked, but I've never had a problem.
							</p>

							<li>Label all three files properly</li>

							<p> My utterances are in a file called utts.data (identical to the file needed by Festival for voice creation) with the format:
<pre>
(audio_0003 "This was easy for us.")
(audio_0004 "Jane may earn more money by working hard.")
(audio_0005 "She is thinner than I am.")
(audio_0006 "Bright sunshine shimmers on the ocean.")
(audio_0007 "Nothing is as offensive as innocence.")
(audio_0008 "Why yell or worry over silly items?")
(audio_0009 "Where were you while we were away?")
</pre>

<p>&nbsp;</p>
							<p> And then I run the shell script <a href="scripts/mkpf.sh">mkpf.sh</a> to double check the audio and create the prompt files.</p>

    </div>
</div>

</div> <!-- end left column -->

</div> <!-- end columns -->

<p>&nbsp;</p>

</body>
</html>
